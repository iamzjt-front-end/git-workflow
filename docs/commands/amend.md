# ä¿®æ”¹æäº¤ä¿¡æ¯

ä¿®æ”¹æŒ‡å®š commit çš„æäº¤ä¿¡æ¯ï¼ˆcommit messageï¼‰ã€‚

## å‘½ä»¤

```bash
# äº¤äº’å¼é€‰æ‹© commit
gw amend

# ç›´æ¥æŒ‡å®š commit hash
gw amend a1b2c3d
gw amend HEAD
gw amend HEAD~2
```

## ä½¿ç”¨æ–¹å¼

### æ–¹å¼ 1: äº¤äº’å¼é€‰æ‹©ï¼ˆæ¨èï¼‰

ä¸å¸¦å‚æ•°è¿è¡Œï¼Œä»æœ€è¿‘ 20 ä¸ª commit ä¸­é€‰æ‹©ï¼š

```bash
gw amend
```

### æ–¹å¼ 2: æŒ‡å®š commit hash

ç›´æ¥æŒ‡å®šè¦ä¿®æ”¹çš„ commitï¼š

```bash
# ä½¿ç”¨çŸ­ hash
gw amend a1b2c3d

# ä½¿ç”¨å®Œæ•´ hash
gw amend a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0

# ä½¿ç”¨ç›¸å¯¹å¼•ç”¨
gw amend HEAD      # æœ€æ–° commit
gw amend HEAD~1    # ä¸Šä¸€ä¸ª commit
gw amend HEAD~2    # ä¸Šä¸Šä¸ª commit
```

## äº¤äº’æµç¨‹

### æ­¥éª¤ 1: é€‰æ‹© commitï¼ˆå¦‚æœæœªæŒ‡å®šï¼‰

```
? é€‰æ‹©è¦ä¿®æ”¹çš„ commit:
â¯ a1b2c3d âœ¨ feat(auth): æ·»åŠ ç”¨æˆ·ç™»å½•åŠŸèƒ½ 2026-01-19 14:30:00
  d4e5f6g ğŸ› fix(auth): ä¿®å¤ç™»å½•bug 2026-01-18 10:20:00
  h7i8j9k ğŸ“ docs: æ›´æ–°æ–‡æ¡£ 2026-01-17 16:45:00
  ...
```

### æ­¥éª¤ 2: æ˜¾ç¤ºå½“å‰ä¿¡æ¯

```
å½“å‰ commit ä¿¡æ¯:
  Hash:    a1b2c3d
  Message: âœ¨ feat(auth): æ·»åŠ ç”¨æˆ·ç™»å½•åŠŸèƒ½
  Date:    2026-01-19 14:30:00 +0800
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

### æ­¥éª¤ 3: è¾“å…¥æ–°çš„ commit message

```
? è¾“å…¥æ–°çš„ commit message: âœ¨ feat(auth): å®ç°ç”¨æˆ·ç™»å½•å’Œæ³¨å†ŒåŠŸèƒ½
```

**æç¤º**: é»˜è®¤ä¼šæ˜¾ç¤ºåŸæ¥çš„ messageï¼Œå¯ä»¥ç›´æ¥ç¼–è¾‘

### æ­¥éª¤ 4: ç¡®è®¤ä¿®æ”¹

```
ä¿®æ”¹é¢„è§ˆ:
  Commit:      a1b2c3d
  æ—§ Message:  âœ¨ feat(auth): æ·»åŠ ç”¨æˆ·ç™»å½•åŠŸèƒ½
  æ–° Message:  âœ¨ feat(auth): å®ç°ç”¨æˆ·ç™»å½•å’Œæ³¨å†ŒåŠŸèƒ½
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

? ç¡®è®¤ä¿®æ”¹? (y/N)
```

## ä½¿ç”¨åœºæ™¯

### åœºæ™¯ 1: ä¿®æ”¹æœ€æ–° commit

```bash
gw amend HEAD
# æˆ–
gw amend

# è¾“å…¥æ–°çš„ message
# ç¡®è®¤

âœ” ä¿®æ”¹æˆåŠŸ
```

**ç‰¹ç‚¹**: ä½¿ç”¨ `git commit --amend`ï¼Œä¸ä¼šæ”¹å˜ commit hash

### åœºæ™¯ 2: ä¿®æ”¹å†å² commit

```bash
gw amend HEAD~3

# è¾“å…¥æ–°çš„ message
# ç¡®è®¤

âš ï¸  è­¦å‘Š: ä¿®æ”¹éæœ€æ–° commit éœ€è¦ä½¿ç”¨ rebaseï¼Œå¯èƒ½ä¼šæ”¹å˜ commit hash
   è¿™ä¼šå½±å“å·²æ¨é€åˆ°è¿œç¨‹çš„ commitï¼Œè¯·è°¨æ…æ“ä½œ

? ç¡®è®¤ä¿®æ”¹? (y/N) y

æ­£åœ¨æ‰§è¡Œ rebase...
âœ” ä¿®æ”¹æˆåŠŸ

âš ï¸  æ³¨æ„: commit hash å·²æ”¹å˜
   å¦‚æœå·²æ¨é€åˆ°è¿œç¨‹ï¼Œéœ€è¦ä½¿ç”¨ force push:
   git push --force-with-lease
```

**ç‰¹ç‚¹**: ä½¿ç”¨ `git filter-branch`ï¼Œä¼šæ”¹å˜ commit hash

### åœºæ™¯ 3: ä¿®æ­£æ‹¼å†™é”™è¯¯

```bash
# å‘ç°æœ€æ–° commit çš„ message æœ‰æ‹¼å†™é”™è¯¯
gw amend HEAD

# æ—§: feat: add logn feature
# æ–°: feat: add login feature

âœ” ä¿®æ”¹æˆåŠŸ
```

### åœºæ™¯ 4: è¡¥å……è¯¦ç»†è¯´æ˜

```bash
gw amend HEAD

# æ—§: fix: bug
# æ–°: fix(auth): ä¿®å¤ç™»å½•é¡µé¢åœ¨ Safari æµè§ˆå™¨ä¸‹çš„å…¼å®¹æ€§é—®é¢˜

âœ” ä¿®æ”¹æˆåŠŸ
```

## æ³¨æ„äº‹é¡¹

### âš ï¸ ä¿®æ”¹å†å² commit

- **ä¼šæ”¹å˜ commit hash** - æ‰€æœ‰åç»­ commit çš„ hash éƒ½ä¼šæ”¹å˜
- **å½±å“å›¢é˜Ÿåä½œ** - å¦‚æœå·²æ¨é€åˆ°è¿œç¨‹ï¼Œå…¶ä»–äººéœ€è¦é‡æ–°æ‹‰å–
- **éœ€è¦ force push** - æ¨é€æ—¶å¿…é¡»ä½¿ç”¨ `--force-with-lease`

### ğŸ”’ Force Push

ä¿®æ”¹å·²æ¨é€çš„ commit åï¼Œéœ€è¦å¼ºåˆ¶æ¨é€ï¼š

```bash
# æ¨èï¼šæ›´å®‰å…¨çš„ force push
git push --force-with-lease

# æˆ–ï¼šå¼ºåˆ¶æ¨é€ï¼ˆä¸æ¨èï¼‰
git push --force
```

### ğŸ“ Commit Message è§„èŒƒ

å»ºè®®éµå¾ª [Conventional Commits](https://www.conventionalcommits.org/) è§„èŒƒï¼š

```
<type>(<scope>): <subject>

<body>

<footer>
```

**ç¤ºä¾‹**:

```
feat(auth): æ·»åŠ ç”¨æˆ·ç™»å½•åŠŸèƒ½

å®ç°äº†åŸºäº JWT çš„ç”¨æˆ·è®¤è¯ç³»ç»Ÿï¼ŒåŒ…æ‹¬ï¼š
- ç™»å½•æ¥å£
- æ³¨å†Œæ¥å£
- Token åˆ·æ–°æœºåˆ¶

Closes #123
```

## ç¤ºä¾‹

### ç¤ºä¾‹ 1: ä¿®æ”¹æœ€æ–° commit çš„ message

```bash
$ gw amend HEAD

å½“å‰ commit ä¿¡æ¯:
  Hash:    a1b2c3d
  Message: feat: add feature
  Date:    2026-01-19 14:30:00

? è¾“å…¥æ–°çš„ commit message: feat(auth): æ·»åŠ ç”¨æˆ·ç™»å½•åŠŸèƒ½

ä¿®æ”¹é¢„è§ˆ:
  Commit:      a1b2c3d
  æ—§ Message:  feat: add feature
  æ–° Message:  feat(auth): æ·»åŠ ç”¨æˆ·ç™»å½•åŠŸèƒ½

? ç¡®è®¤ä¿®æ”¹? y

âœ” ä¿®æ”¹æˆåŠŸ
```

### ç¤ºä¾‹ 2: ä¿®æ”¹æŒ‡å®š hash çš„ commit

```bash
$ gw amend d4e5f6g

å½“å‰ commit ä¿¡æ¯:
  Hash:    d4e5f6g
  Message: fix bug
  Date:    2026-01-18 10:20:00

? è¾“å…¥æ–°çš„ commit message: fix(auth): ä¿®å¤ç™»å½•é¡µé¢å´©æºƒé—®é¢˜

âš ï¸  è­¦å‘Š: ä¿®æ”¹éæœ€æ–° commit éœ€è¦ä½¿ç”¨ rebaseï¼Œå¯èƒ½ä¼šæ”¹å˜ commit hash

? ç¡®è®¤ä¿®æ”¹? y

æ­£åœ¨æ‰§è¡Œ rebase...
âœ” ä¿®æ”¹æˆåŠŸ

âš ï¸  æ³¨æ„: commit hash å·²æ”¹å˜
   å¦‚æœå·²æ¨é€åˆ°è¿œç¨‹ï¼Œéœ€è¦ä½¿ç”¨ force push:
   git push --force-with-lease
```

### ç¤ºä¾‹ 3: äº¤äº’å¼é€‰æ‹©å¹¶ä¿®æ”¹

```bash
$ gw amend

? é€‰æ‹©è¦ä¿®æ”¹çš„ commit:
â¯ a1b2c3d feat: add feature 2026-01-19 14:30:00
  d4e5f6g fix: bug 2026-01-18 10:20:00

? è¾“å…¥æ–°çš„ commit message: feat(auth): æ·»åŠ ç”¨æˆ·ç™»å½•å’Œæ³¨å†ŒåŠŸèƒ½

? ç¡®è®¤ä¿®æ”¹? y

âœ” ä¿®æ”¹æˆåŠŸ
```

## ç›¸å…³å‘½ä»¤

- `gw c` - æäº¤ä»£ç 
- `gw ad` - ä¿®æ”¹æäº¤æ—¶é—´
- `gw log` - æŸ¥çœ‹æäº¤æ—¥å¿—
- `git commit --amend` - Git åŸç”Ÿä¿®æ”¹å‘½ä»¤

## æŠ€æœ¯ç»†èŠ‚

### å®ç°æ–¹å¼

**æœ€æ–° commit**:

```bash
git commit --amend -m "æ–°çš„ commit message"
```

**å†å² commit**:

```bash
git filter-branch -f --msg-filter '
  if [ "$GIT_COMMIT" = "commit-hash" ]; then
    echo "æ–°çš„ commit message"
  else
    cat
  fi
' parent-hash..HEAD
```

### ä¸ git commit --amend çš„åŒºåˆ«

| ç‰¹æ€§            | gw amend | git commit --amend |
| --------------- | -------- | ------------------ |
| ä¿®æ”¹æœ€æ–° commit | âœ…       | âœ…                 |
| ä¿®æ”¹å†å² commit | âœ…       | âŒ                 |
| äº¤äº’å¼é€‰æ‹©      | âœ…       | âŒ                 |
| æŒ‡å®š hash       | âœ…       | âŒ                 |
| é¢„è§ˆä¿®æ”¹        | âœ…       | âŒ                 |
| å®‰å…¨æç¤º        | âœ…       | âŒ                 |

## å¸¸è§é—®é¢˜

### Q: ä¿®æ”¹ commit message ä¼šæ”¹å˜ commit hash å—ï¼Ÿ

A:

- **æœ€æ–° commit**: ä¼šæ”¹å˜ hashï¼ˆå› ä¸º message æ˜¯ hash è®¡ç®—çš„ä¸€éƒ¨åˆ†ï¼‰
- **å†å² commit**: ä¼šæ”¹å˜è¯¥ commit åŠæ‰€æœ‰åç»­ commit çš„ hash

### Q: å¯ä»¥ä¿®æ”¹å¤šè¡Œ commit message å—ï¼Ÿ

A: å¯ä»¥ï¼Œç›´æ¥åœ¨è¾“å…¥æ—¶æ¢è¡Œå³å¯ã€‚ä½†å»ºè®®ä½¿ç”¨ç®€æ´çš„å•è¡Œ messageï¼Œè¯¦ç»†è¯´æ˜æ”¾åœ¨ body éƒ¨åˆ†ã€‚

### Q: ä¿®æ”¹åå¦‚ä½•éªŒè¯ï¼Ÿ

A: ä½¿ç”¨ `gw log` æˆ– `git log` æŸ¥çœ‹æäº¤å†å²ï¼Œç¡®è®¤ message å·²æ›´æ–°ã€‚

```bash
gw log
# æˆ–
git log --oneline
```

### Q: ä¿®æ”¹å¤±è´¥æ€ä¹ˆåŠï¼Ÿ

A: å¦‚æœä¿®æ”¹å†å² commit å¤±è´¥ï¼Œå¯ä»¥ä½¿ç”¨ `git reflog` æ‰¾å›ä¹‹å‰çš„çŠ¶æ€ï¼š

```bash
git reflog
git reset --hard HEAD@{1}
```

### Q: å¯ä»¥æ‰¹é‡ä¿®æ”¹å¤šä¸ª commit å—ï¼Ÿ

A: å½“å‰ç‰ˆæœ¬ä¸æ”¯æŒæ‰¹é‡ä¿®æ”¹ã€‚å¦‚éœ€æ‰¹é‡ä¿®æ”¹ï¼Œå»ºè®®ä½¿ç”¨ `git rebase -i` å‘½ä»¤ã€‚

### Q: ä¸ gw c æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

A:

- `gw c` - åˆ›å»ºæ–°çš„ commit
- `gw amend` - ä¿®æ”¹å·²æœ‰çš„ commit message

## æœ€ä½³å®è·µ

### 1. ä¿®æ”¹å‰å…ˆæ£€æŸ¥çŠ¶æ€

```bash
# æŸ¥çœ‹å½“å‰åˆ†æ”¯å’Œæäº¤å†å²
gw log

# ç¡®è®¤è¦ä¿®æ”¹çš„ commit
git log --oneline -5
```

### 2. éµå¾ª commit message è§„èŒƒ

ä½¿ç”¨ Conventional Commits æ ¼å¼ï¼š

```
feat: æ–°åŠŸèƒ½
fix: ä¿®å¤ bug
docs: æ–‡æ¡£æ›´æ–°
style: ä»£ç æ ¼å¼
refactor: é‡æ„
perf: æ€§èƒ½ä¼˜åŒ–
test: æµ‹è¯•ç›¸å…³
chore: å…¶ä»–æ‚é¡¹
```

### 3. ä¿®æ”¹ååŠæ—¶æ¨é€

```bash
# ä¿®æ”¹åç«‹å³æ¨é€ï¼Œé¿å…ä¸ä»–äººå†²çª
git push --force-with-lease
```

### 4. å›¢é˜Ÿåä½œæ—¶è°¨æ…ä½¿ç”¨

å¦‚æœ commit å·²ç»è¢«å…¶ä»–äººæ‹‰å–ï¼Œä¿®æ”¹ä¼šå¯¼è‡´å†²çªã€‚å»ºè®®ï¼š

- åªä¿®æ”¹æœ¬åœ°æœªæ¨é€çš„ commit
- æˆ–åœ¨å›¢é˜Ÿå†…æå‰æ²Ÿé€š
