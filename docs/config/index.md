# é…ç½®æ¦‚è§ˆ

Git Workflow æä¾›äº†çµæ´»çš„é…ç½®ç³»ç»Ÿï¼Œæ”¯æŒå…¨å±€é…ç½®å’Œé¡¹ç›®é…ç½®ï¼Œè®©ä½ å¯ä»¥æ ¹æ®ä¸åŒçš„éœ€æ±‚è‡ªå®šä¹‰å·¥å…·è¡Œä¸ºã€‚

## ğŸ¯ é…ç½®ç†å¿µ

### çº¦å®šä¼˜äºé…ç½®

Git Workflow éµå¾ª"çº¦å®šä¼˜äºé…ç½®"çš„åŸåˆ™ï¼š

- **é›¶é…ç½®å¼€ç®±å³ç”¨** - æ— éœ€ä»»ä½•é…ç½®å³å¯å¼€å§‹ä½¿ç”¨
- **åˆç†çš„é»˜è®¤å€¼** - æä¾›é€‚åˆå¤§å¤šæ•°åœºæ™¯çš„é»˜è®¤é…ç½®
- **æ¸è¿›å¼é…ç½®** - å¯ä»¥æ ¹æ®éœ€è¦é€æ­¥æ·»åŠ é…ç½®é¡¹

### çµæ´»çš„é…ç½®å±‚çº§

æ”¯æŒå¤šå±‚çº§é…ç½®ï¼Œæ»¡è¶³ä¸åŒåœºæ™¯éœ€æ±‚ï¼š

1. **å†…ç½®é»˜è®¤é…ç½®** - å·¥å…·å†…ç½®çš„åŸºç¡€é…ç½®
2. **å…¨å±€é…ç½®** - å¯¹æ‰€æœ‰é¡¹ç›®ç”Ÿæ•ˆçš„ä¸ªäººé…ç½®
3. **é¡¹ç›®é…ç½®** - ä»…å¯¹å½“å‰é¡¹ç›®ç”Ÿæ•ˆçš„å›¢é˜Ÿé…ç½®

**é…ç½®ä¼˜å…ˆçº§ï¼š** é¡¹ç›®é…ç½® > å…¨å±€é…ç½® > é»˜è®¤é…ç½®

## ğŸ“ é…ç½®æ–‡ä»¶ä½ç½®

### å…¨å±€é…ç½®

```
~/.gwrc.json
```

**ç‰¹ç‚¹ï¼š**
- å¯¹æ‰€æœ‰é¡¹ç›®ç”Ÿæ•ˆ
- é€‚åˆä¸ªäººåå¥½è®¾ç½®
- ä¸€æ¬¡é…ç½®ï¼Œå¤„å¤„ä½¿ç”¨

**é€‚ç”¨åœºæ™¯ï¼š**
- AI commit é…ç½®ï¼ˆAPI keyã€æä¾›å•†ç­‰ï¼‰
- ä¸ªäººä¹ æƒ¯é…ç½®ï¼ˆemojiã€è‡ªåŠ¨æš‚å­˜ç­‰ï¼‰
- é€šç”¨çš„åˆ†æ”¯å‘½åè§„èŒƒ

### é¡¹ç›®é…ç½®

æ”¯æŒå¤šç§æ–‡ä»¶åï¼ŒæŒ‰ä¼˜å…ˆçº§æŸ¥æ‰¾ï¼š

```
.gwrc.json          # æ¨èï¼ŒJSON æ ¼å¼
.gwrc               # ç®€åŒ–æ–‡ä»¶å
gw.config.json      # æ˜ç¡®çš„é…ç½®æ–‡ä»¶å
```

**ç‰¹ç‚¹ï¼š**
- ä»…å¯¹å½“å‰é¡¹ç›®ç”Ÿæ•ˆ
- å¯ä»¥æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶
- å›¢é˜Ÿæˆå‘˜å…±äº«é…ç½®

**é€‚ç”¨åœºæ™¯ï¼š**
- å›¢é˜Ÿç»Ÿä¸€çš„åˆ†æ”¯è§„èŒƒ
- é¡¹ç›®ç‰¹å®šçš„ ID è¦æ±‚
- ç‰¹æ®Šçš„åˆ†æ”¯å‰ç¼€

### æŸ¥æ‰¾é¡ºåº

Git Workflow æŒ‰ä»¥ä¸‹é¡ºåºæŸ¥æ‰¾é…ç½®æ–‡ä»¶ï¼š

1. **å½“å‰ç›®å½•** - `./gwrc.json`
2. **Git ä»“åº“æ ¹ç›®å½•** - `<git-root>/.gwrc.json`
3. **ç”¨æˆ·ä¸»ç›®å½•** - `~/.gwrc.json`
4. **å†…ç½®é»˜è®¤é…ç½®**

## ğŸš€ å¿«é€Ÿå¼€å§‹

### åˆ›å»ºå…¨å±€é…ç½®ï¼ˆæ¨èï¼‰

```bash
gw init
```

é€‰æ‹©é…ç½®èŒƒå›´ï¼š

```
âš™ï¸  åˆå§‹åŒ– git-workflow é…ç½®

? é€‰æ‹©é…ç½®èŒƒå›´:
â¯ å…¨å±€é…ç½®ï¼ˆæ‰€æœ‰é¡¹ç›®ç”Ÿæ•ˆï¼‰      # æ¨èï¼é…ç½®ä¸€æ¬¡ï¼Œæ‰€æœ‰é¡¹ç›®éƒ½èƒ½ç”¨
  é¡¹ç›®é…ç½®ï¼ˆä»…å½“å‰é¡¹ç›®ï¼‰         # ä¸ºç‰¹å®šé¡¹ç›®è‡ªå®šä¹‰é…ç½®
```

é€‰æ‹© **å…¨å±€é…ç½®**ï¼ŒæŒ‰æç¤ºå®Œæˆé…ç½®ï¼š

```
âœ” é€‰æ‹©é…ç½®èŒƒå›´: å…¨å±€é…ç½®ï¼ˆæ‰€æœ‰é¡¹ç›®ç”Ÿæ•ˆï¼‰

? Feature åˆ†æ”¯å‰ç¼€: feature
? Hotfix åˆ†æ”¯å‰ç¼€: hotfix
? æ˜¯å¦å¼ºåˆ¶è¦æ±‚å¡«å†™ ID: å¦
? Feature åˆ†æ”¯ ID æ ‡ç­¾: Story ID
? Hotfix åˆ†æ”¯ ID æ ‡ç­¾: Issue ID
? æäº¤æ—¶æ˜¯å¦è‡ªåŠ¨æš‚å­˜æ‰€æœ‰æ›´æ”¹: æ˜¯
? æ˜¯å¦ä½¿ç”¨ emoji: æ˜¯

? æ˜¯å¦å¯ç”¨ AI commit åŠŸèƒ½: æ˜¯
? é€‰æ‹© AI æä¾›å•†: GitHub Modelsï¼ˆå…è´¹ï¼Œæ¨èï¼‰
? è¾“å…¥ä½ çš„ GitHub Token: ghp_xxxxxxxxxxxx
? é€‰æ‹©è¯­è¨€: ä¸­æ–‡

âœ” å…¨å±€é…ç½®å·²ä¿å­˜åˆ°: ~/.gwrc.json
```

### åˆ›å»ºé¡¹ç›®é…ç½®

åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œï¼š

```bash
cd your-project
gw init
```

é€‰æ‹© **é¡¹ç›®é…ç½®**ï¼Œé…ç½®å›¢é˜Ÿè§„èŒƒï¼š

```
âœ” é€‰æ‹©é…ç½®èŒƒå›´: é¡¹ç›®é…ç½®ï¼ˆä»…å½“å‰é¡¹ç›®ï¼‰

? æ˜¯å¦å¼ºåˆ¶è¦æ±‚å¡«å†™ ID: æ˜¯
? Feature åˆ†æ”¯ ID æ ‡ç­¾: Jira ID
? Hotfix åˆ†æ”¯ ID æ ‡ç­¾: Bug ID
? åˆ›å»ºåˆ†æ”¯åæ˜¯å¦è‡ªåŠ¨æ¨é€åˆ°è¿œç¨‹: æ˜¯
? é»˜è®¤åŸºç¡€åˆ†æ”¯: develop

âœ” é¡¹ç›®é…ç½®å·²ä¿å­˜åˆ°: .gwrc.json
```

## ğŸ“‹ é…ç½®é¡¹è¯¦è§£

### å®Œæ•´é…ç½®ç¤ºä¾‹

```json
{
  "baseBranch": "develop",
  "featurePrefix": "feature",
  "hotfixPrefix": "hotfix",
  "requireId": true,
  "featureIdLabel": "Jira ID",
  "hotfixIdLabel": "Bug ID",
  "defaultTagPrefix": "v",
  "autoPush": true,
  "autoStage": true,
  "useEmoji": true,
  "commitEmojis": {
    "feat": "âœ¨",
    "fix": "ğŸ›",
    "docs": "ğŸ“"
  },
  "aiCommit": {
    "enabled": true,
    "provider": "github",
    "apiKey": "ghp_xxxxxxxxxxxx",
    "model": "gpt-4o-mini",
    "language": "zh-CN",
    "maxTokens": 200,
    "detailedDescription": false
  }
}
```

### åŸºç¡€é…ç½®

| é…ç½®é¡¹           | ç±»å‹      | é»˜è®¤å€¼      | è¯´æ˜                                     |
| ---------------- | --------- | ----------- | ---------------------------------------- |
| `baseBranch`     | `string`  | è‡ªåŠ¨æ£€æµ‹    | é»˜è®¤åŸºç¡€åˆ†æ”¯ï¼Œä¸è®¾ç½®åˆ™è‡ªåŠ¨æ£€æµ‹ main/master |
| `featurePrefix`  | `string`  | `"feature"` | feature åˆ†æ”¯å‰ç¼€                         |
| `hotfixPrefix`   | `string`  | `"hotfix"`  | hotfix åˆ†æ”¯å‰ç¼€                          |

### åˆ†æ”¯é…ç½®

| é…ç½®é¡¹             | ç±»å‹      | é»˜è®¤å€¼       | è¯´æ˜                                                                            |
| ------------------ | --------- | ------------ | ------------------------------------------------------------------------------- |
| `requireId`        | `boolean` | `false`      | æ˜¯å¦å¼ºåˆ¶è¦æ±‚å¡«å†™ IDã€‚å¼€å¯ååˆ›å»ºåˆ†æ”¯æ—¶å¿…é¡»å¡«å†™ IDï¼Œä¸èƒ½è·³è¿‡                      |
| `featureIdLabel`   | `string`  | `"Story ID"` | feature åˆ†æ”¯ ID æç¤ºæ–‡å­—                                                        |
| `hotfixIdLabel`    | `string`  | `"Issue ID"` | hotfix åˆ†æ”¯ ID æç¤ºæ–‡å­—                                                         |
| `autoPush`         | `boolean` | -            | åˆ›å»ºåˆ†æ”¯åæ˜¯å¦è‡ªåŠ¨æ¨é€åˆ°è¿œç¨‹ã€‚`true` è‡ªåŠ¨æ¨é€ï¼Œ`false` ä¸æ¨é€ï¼Œä¸è®¾ç½®åˆ™æ¯æ¬¡è¯¢é—® |

### ç‰ˆæœ¬é…ç½®

| é…ç½®é¡¹             | ç±»å‹     | é»˜è®¤å€¼ | è¯´æ˜                              |
| ------------------ | -------- | ------ | --------------------------------- |
| `defaultTagPrefix` | `string` | -      | é»˜è®¤ tag å‰ç¼€ï¼Œè®¾ç½®åè·³è¿‡é€‰æ‹©æ­¥éª¤ |

### æäº¤é…ç½®

| é…ç½®é¡¹         | ç±»å‹      | é»˜è®¤å€¼ | è¯´æ˜                          |
| -------------- | --------- | ------ | ----------------------------- |
| `autoStage`    | `boolean` | `true` | commit æ—¶æ˜¯å¦è‡ªåŠ¨æš‚å­˜æ‰€æœ‰æ›´æ”¹ |
| `useEmoji`     | `boolean` | `true` | commit æ—¶æ˜¯å¦ä½¿ç”¨ emoji       |
| `commitEmojis` | `object`  | -      | è‡ªå®šä¹‰å„ç±»å‹ commit çš„ emoji  |

### AI é…ç½®

| é…ç½®é¡¹                        | ç±»å‹      | é»˜è®¤å€¼     | è¯´æ˜                                                 |
| ----------------------------- | --------- | ---------- | ---------------------------------------------------- |
| `aiCommit.enabled`            | `boolean` | `true`     | æ˜¯å¦å¯ç”¨ AI commit åŠŸèƒ½                              |
| `aiCommit.provider`           | `string`  | `"github"` | AI æä¾›å•†ï¼š`github` / `openai` / `claude` / `ollama` |
| `aiCommit.apiKey`             | `string`  | -          | API keyï¼Œç•™ç©ºä½¿ç”¨å†…ç½® key                            |
| `aiCommit.model`              | `string`  | æ ¹æ®æä¾›å•† | æ¨¡å‹åç§°                                             |
| `aiCommit.language`           | `string`  | `"zh-CN"`  | ç”Ÿæˆè¯­è¨€ï¼š`zh-CN` / `en-US`                          |
| `aiCommit.maxTokens`          | `number`  | `200`      | æœ€å¤§ token æ•°                                        |
| `aiCommit.detailedDescription` | `boolean` | `false`    | æ˜¯å¦ç”Ÿæˆè¯¦ç»†çš„ä¿®æ”¹ç‚¹æè¿°                             |

## ğŸ¨ é…ç½®åœºæ™¯

### åœºæ™¯ä¸€ï¼šä¸ªäººå¼€å‘è€…

**éœ€æ±‚ï¼š**
- å¯ç”¨ AI commit
- ä½¿ç”¨ emoji
- è‡ªåŠ¨æš‚å­˜æ–‡ä»¶
- ä¸å¼ºåˆ¶è¦æ±‚ ID

**é…ç½®ï¼š**

```json
{
  "autoStage": true,
  "useEmoji": true,
  "requireId": false,
  "aiCommit": {
    "enabled": true,
    "provider": "github",
    "language": "zh-CN"
  }
}
```

### åœºæ™¯äºŒï¼šå›¢é˜Ÿåä½œ

**éœ€æ±‚ï¼š**
- ç»Ÿä¸€åˆ†æ”¯å‘½åè§„èŒƒ
- å¼ºåˆ¶å…³è” Issue/Story
- è‡ªåŠ¨æ¨é€åˆ°è¿œç¨‹
- åŸºäº develop åˆ†æ”¯å¼€å‘

**é…ç½®ï¼š**

```json
{
  "baseBranch": "develop",
  "requireId": true,
  "featureIdLabel": "Jira ID",
  "hotfixIdLabel": "Bug ID",
  "autoPush": true
}
```

### åœºæ™¯ä¸‰ï¼šä¼ä¸šçº§é¡¹ç›®

**éœ€æ±‚ï¼š**
- ä¸¥æ ¼çš„åˆ†æ”¯è§„èŒƒ
- ç¦ç”¨ emojiï¼ˆCI/CD å…¼å®¹æ€§ï¼‰
- è‡ªå®šä¹‰åˆ†æ”¯å‰ç¼€
- æ‰‹åŠ¨é€‰æ‹©æš‚å­˜æ–‡ä»¶

**é…ç½®ï¼š**

```json
{
  "featurePrefix": "feat",
  "hotfixPrefix": "fix",
  "requireId": true,
  "featureIdLabel": "éœ€æ±‚ç¼–å·",
  "hotfixIdLabel": "ç¼ºé™·ç¼–å·",
  "useEmoji": false,
  "autoStage": false,
  "aiCommit": {
    "enabled": false
  }
}
```

### åœºæ™¯å››ï¼šå¼€æºé¡¹ç›®

**éœ€æ±‚ï¼š**
- è‹±æ–‡æäº¤ä¿¡æ¯
- ä½¿ç”¨ emoji
- ä¸å¼ºåˆ¶ ID
- åŸºäº main åˆ†æ”¯

**é…ç½®ï¼š**

```json
{
  "baseBranch": "main",
  "requireId": false,
  "useEmoji": true,
  "aiCommit": {
    "enabled": true,
    "language": "en-US"
  }
}
```

## ğŸ”§ é…ç½®ç®¡ç†

### æŸ¥çœ‹å½“å‰é…ç½®

```bash
# æŸ¥çœ‹ç”Ÿæ•ˆçš„é…ç½®
gw config show

# æŸ¥çœ‹é…ç½®æ–‡ä»¶ä½ç½®
gw config path
```

### ç¼–è¾‘é…ç½®

```bash
# ç¼–è¾‘å…¨å±€é…ç½®
gw config edit --global

# ç¼–è¾‘é¡¹ç›®é…ç½®
gw config edit --local
```

### é‡ç½®é…ç½®

```bash
# é‡ç½®ä¸ºé»˜è®¤é…ç½®
gw config reset

# åˆ é™¤é…ç½®æ–‡ä»¶
gw config clean
```

### éªŒè¯é…ç½®

```bash
# éªŒè¯é…ç½®æ–‡ä»¶è¯­æ³•
gw config validate

# æµ‹è¯•é…ç½®æ•ˆæœ
gw config test
```

## ğŸ“š é…ç½®æœ€ä½³å®è·µ

### 1. åˆ†å±‚é…ç½®ç­–ç•¥

**å…¨å±€é…ç½®ï¼ˆä¸ªäººåå¥½ï¼‰ï¼š**
```json
{
  "aiCommit": {
    "enabled": true,
    "provider": "github",
    "apiKey": "your-token"
  },
  "useEmoji": true,
  "autoStage": true
}
```

**é¡¹ç›®é…ç½®ï¼ˆå›¢é˜Ÿè§„èŒƒï¼‰ï¼š**
```json
{
  "requireId": true,
  "featureIdLabel": "Jira ID",
  "autoPush": true,
  "baseBranch": "develop"
}
```

### 2. ç‰ˆæœ¬æ§åˆ¶

**æäº¤é¡¹ç›®é…ç½®ï¼š**
```bash
git add .gwrc.json
git commit -m "chore: add git-workflow config"
```

**å¿½ç•¥æ•æ„Ÿä¿¡æ¯ï¼š**
```gitignore
# .gitignore
.gwrc.local.json  # æœ¬åœ°è¦†ç›–é…ç½®
```

### 3. å›¢é˜Ÿåä½œ

**æ–‡æ¡£åŒ–é…ç½®ï¼š**
```markdown
# é¡¹ç›®é…ç½®è¯´æ˜

æœ¬é¡¹ç›®ä½¿ç”¨ git-workflow è¿›è¡Œç‰ˆæœ¬ç®¡ç†ï¼Œé…ç½®å¦‚ä¸‹ï¼š

- åˆ†æ”¯å‰ç¼€ï¼šfeature/ã€hotfix/
- å¿…é¡»å¡«å†™ Jira ID
- åŸºäº develop åˆ†æ”¯å¼€å‘
- è‡ªåŠ¨æ¨é€åˆ°è¿œç¨‹

## å®‰è£…å’Œé…ç½®

1. å®‰è£…å·¥å…·ï¼š`npm install -g @zjex/git-workflow`
2. é…ç½®å·²åŒ…å«åœ¨é¡¹ç›®ä¸­ï¼Œæ— éœ€é¢å¤–é…ç½®
3. å¼€å§‹ä½¿ç”¨ï¼š`gw f` åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
```

### 4. é…ç½®è¿ç§»

**ä»æ—§ç‰ˆæœ¬è¿ç§»ï¼š**
```bash
# å¤‡ä»½æ—§é…ç½®
cp ~/.gwrc.json ~/.gwrc.json.backup

# é‡æ–°åˆå§‹åŒ–
gw init --migrate
```

**è·¨é¡¹ç›®å¤åˆ¶é…ç½®ï¼š**
```bash
# å¤åˆ¶é…ç½®åˆ°æ–°é¡¹ç›®
cp project-a/.gwrc.json project-b/.gwrc.json
```

## ğŸ” æ•…éšœæ’é™¤

### é…ç½®æ–‡ä»¶è¯­æ³•é”™è¯¯

```bash
âŒ é…ç½®æ–‡ä»¶è¯­æ³•é”™è¯¯: Unexpected token } in JSON
```

**è§£å†³æ–¹æ¡ˆï¼š**
1. ä½¿ç”¨ JSON éªŒè¯å·¥å…·æ£€æŸ¥è¯­æ³•
2. é‡æ–°è¿è¡Œ `gw init` ç”Ÿæˆæ–°é…ç½®
3. å‚è€ƒæ–‡æ¡£ä¸­çš„é…ç½®ç¤ºä¾‹

### é…ç½®é¡¹ä¸ç”Ÿæ•ˆ

```bash
âŒ é…ç½®é¡¹ 'unknownOption' ä¸è¢«è¯†åˆ«
```

**è§£å†³æ–¹æ¡ˆï¼š**
1. æ£€æŸ¥é…ç½®é¡¹åç§°æ˜¯å¦æ­£ç¡®
2. æŸ¥çœ‹æ–‡æ¡£ç¡®è®¤æ”¯æŒçš„é…ç½®é¡¹
3. æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬

### æƒé™é—®é¢˜

```bash
âŒ æ— æ³•å†™å…¥é…ç½®æ–‡ä»¶: Permission denied
```

**è§£å†³æ–¹æ¡ˆï¼š**
1. æ£€æŸ¥æ–‡ä»¶æƒé™ï¼š`ls -la ~/.gwrc.json`
2. ä¿®æ”¹æƒé™ï¼š`chmod 644 ~/.gwrc.json`
3. ä½¿ç”¨ sudoï¼ˆä¸æ¨èï¼‰

### é…ç½®å†²çª

```bash
âš ï¸ é¡¹ç›®é…ç½®ä¸å…¨å±€é…ç½®å­˜åœ¨å†²çª
```

**è§£å†³æ–¹æ¡ˆï¼š**
1. é¡¹ç›®é…ç½®ä¼˜å…ˆçº§æ›´é«˜ï¼Œä¼šè¦†ç›–å…¨å±€é…ç½®
2. æ£€æŸ¥é…ç½®åˆå¹¶ç»“æœï¼š`gw config show`
3. æ ¹æ®éœ€è¦è°ƒæ•´é…ç½®

## ğŸ“– æ·±å…¥å­¦ä¹ 

- [**é…ç½®æ–‡ä»¶è¯¦è§£**](/config/config-file) - äº†è§£æ‰€æœ‰é…ç½®é¡¹çš„è¯¦ç»†è¯´æ˜
- [**AI é…ç½®**](/config/ai-config) - æ·±å…¥é…ç½® AI commit åŠŸèƒ½
- [**åˆ†æ”¯é…ç½®**](/config/branch-config) - è‡ªå®šä¹‰åˆ†æ”¯ç®¡ç†è¡Œä¸º
- [**æäº¤é…ç½®**](/config/commit-config) - é…ç½®æäº¤ç›¸å…³åŠŸèƒ½
- [**é…ç½®ç¤ºä¾‹**](/config/examples) - æŸ¥çœ‹æ›´å¤šå®é™…é…ç½®æ¡ˆä¾‹

---

é€šè¿‡åˆç†çš„é…ç½®ï¼ŒGit Workflow å¯ä»¥å®Œç¾é€‚åº”ä½ çš„å·¥ä½œæµç¨‹ã€‚ä»ç®€å•çš„ä¸ªäººé¡¹ç›®åˆ°å¤æ‚çš„ä¼ä¸šçº§åº”ç”¨ï¼Œéƒ½èƒ½æ‰¾åˆ°åˆé€‚çš„é…ç½®æ–¹æ¡ˆã€‚