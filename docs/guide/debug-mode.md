# Debug æ¨¡å¼

Debug æ¨¡å¼å¯ä»¥å¸®åŠ©ä½ è¯Šæ–­å‘½ä»¤æ‰§è¡Œå¤±è´¥çš„åŸå› ï¼Œæ˜¾ç¤ºè¯¦ç»†çš„å‘½ä»¤ã€è¾“å‡ºå’Œé”™è¯¯ä¿¡æ¯ã€‚

## å¯ç”¨ Debug æ¨¡å¼

åœ¨ä»»ä½•å‘½ä»¤åæ·»åŠ  `--debug` æˆ– `-d` å‚æ•°ï¼š

```bash
# åŸºæœ¬ç”¨æ³•
gw tag --debug
gw tag -d

# å…¶ä»–å‘½ä»¤
gw f --debug
gw b --debug
gw c --debug
gw s --debug
```

## Debug è¾“å‡ºå†…å®¹

å¯ç”¨ debug æ¨¡å¼åï¼Œä½ ä¼šçœ‹åˆ°ï¼š

### 1. æ¨¡å¼æç¤º

```
ğŸ› Debug æ¨¡å¼å·²å¯ç”¨
```

### 2. æ‰§è¡Œçš„å‘½ä»¤

æ¯æ¬¡æ‰§è¡Œ Git å‘½ä»¤æ—¶ï¼Œä¼šæ˜¾ç¤ºå®Œæ•´çš„å‘½ä»¤å­—ç¬¦ä¸²ï¼š

```
[DEBUG] æ‰§è¡Œå‘½ä»¤: git tag -a "v1.5.3" -m "Release v1.5.3"
```

### 3. é€€å‡ºç 

å‘½ä»¤æ‰§è¡Œå®Œæˆåæ˜¾ç¤ºé€€å‡ºç ï¼š

```
[DEBUG] é€€å‡ºç : 0
```

- `0` è¡¨ç¤ºæˆåŠŸ
- é `0` è¡¨ç¤ºå¤±è´¥

### 4. æ ‡å‡†è¾“å‡º

å¦‚æœå‘½ä»¤æœ‰æ ‡å‡†è¾“å‡ºï¼Œä¼šæ˜¾ç¤ºï¼š

```
[DEBUG] æ ‡å‡†è¾“å‡º:
Counting objects: 3, done.
Writing objects: 100% (3/3), 256 bytes | 256.00 KiB/s, done.
Total 3 (delta 0), reused 0 (delta 0)
```

### 5. é”™è¯¯è¾“å‡º

å¦‚æœå‘½ä»¤å¤±è´¥ï¼Œä¼šæ˜¾ç¤ºè¯¦ç»†çš„é”™è¯¯ä¿¡æ¯ï¼š

```
[DEBUG] é”™è¯¯è¾“å‡º:
fatal: Failed to resolve 'HEAD' as a valid ref.
```

### 6. æ•…éšœæ’æŸ¥ä¿¡æ¯

å‘½ä»¤å¤±è´¥æ—¶ï¼Œè¿˜ä¼šæ˜¾ç¤ºé¢å¤–çš„æ’æŸ¥ä¿¡æ¯ï¼š

```
[DEBUG] æ•…éšœæ’æŸ¥ä¿¡æ¯:
  å‘½ä»¤: git tag -a "v1.5.3" -m "Release v1.5.3"
  å·¥ä½œç›®å½•: /Users/username/project
  Shell: /bin/zsh
  å»ºè®®: å°è¯•åœ¨ç»ˆç«¯ä¸­ç›´æ¥è¿è¡Œä¸Šè¿°å‘½ä»¤ä»¥è·å–æ›´å¤šä¿¡æ¯
```

## ä½¿ç”¨åœºæ™¯

### åœºæ™¯ 1ï¼šTag åˆ›å»ºå¤±è´¥

```bash
$ gw tag --debug

ğŸ› Debug æ¨¡å¼å·²å¯ç”¨

âœ” é€‰æ‹© tag å‰ç¼€: v (æœ€æ–°: v1.5.2)
å½“å‰æœ€æ–° tag: v1.5.2

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âœ” é€‰æ‹©ç‰ˆæœ¬ç±»å‹: patch  â†’ v1.5.3

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[DEBUG] æ‰§è¡Œå‘½ä»¤: git tag -a "v1.5.3" -m "Release v1.5.3"
[DEBUG] é€€å‡ºç : 128
[DEBUG] é”™è¯¯è¾“å‡º:
fatal: Failed to resolve 'HEAD' as a valid ref.

âœ— tag åˆ›å»ºå¤±è´¥
  fatal: Failed to resolve 'HEAD' as a valid ref.

[DEBUG] æ•…éšœæ’æŸ¥ä¿¡æ¯:
  å‘½ä»¤: git tag -a "v1.5.3" -m "Release v1.5.3"
  å·¥ä½œç›®å½•: /Users/username/cmk-vue
  Shell: /bin/zsh
  å»ºè®®: å°è¯•åœ¨ç»ˆç«¯ä¸­ç›´æ¥è¿è¡Œä¸Šè¿°å‘½ä»¤ä»¥è·å–æ›´å¤šä¿¡æ¯
```

ä»è¿™ä¸ªè¾“å‡ºå¯ä»¥çœ‹å‡ºï¼š

- å‘½ä»¤æœ¬èº«æ˜¯æ­£ç¡®çš„ï¼ˆå¼•å·å¤„ç†æ­£å¸¸ï¼‰
- é€€å‡ºç  128 è¡¨ç¤º Git é”™è¯¯
- é”™è¯¯åŸå› ï¼š`HEAD` æ— æ³•è§£æï¼ˆä»“åº“æ²¡æœ‰æäº¤ï¼‰

### åœºæ™¯ 2ï¼šåˆ†æ”¯æ¨é€å¤±è´¥

```bash
$ gw f --debug

ğŸ› Debug æ¨¡å¼å·²å¯ç”¨

âœ” è¯·è¾“å…¥éœ€æ±‚ID: 123
âœ” è¯·è¾“å…¥æè¿°: add-feature

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[DEBUG] æ‰§è¡Œå‘½ä»¤: git fetch origin main
[DEBUG] é€€å‡ºç : 0

[DEBUG] æ‰§è¡Œå‘½ä»¤: git checkout -b "feature/20240120-123-add-feature" origin/main
[DEBUG] é€€å‡ºç : 0
[DEBUG] æ ‡å‡†è¾“å‡º:
Switched to a new branch 'feature/20240120-123-add-feature'

âœ” åˆ†æ”¯åˆ›å»ºæˆåŠŸ: feature/20240120-123-add-feature

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

(è‡ªåŠ¨æ¨é€å·²å¯ç”¨)

[DEBUG] æ‰§è¡Œå‘½ä»¤: git push -u origin "feature/20240120-123-add-feature"
[DEBUG] é€€å‡ºç : 128
[DEBUG] é”™è¯¯è¾“å‡º:
fatal: unable to access 'https://github.com/user/repo.git/': Could not resolve host: github.com

âœ— è¿œç¨‹æ¨é€å¤±è´¥
  fatal: unable to access 'https://github.com/user/repo.git/': Could not resolve host: github.com

[DEBUG] æ•…éšœæ’æŸ¥ä¿¡æ¯:
  å‘½ä»¤: git push -u origin "feature/20240120-123-add-feature"
  å·¥ä½œç›®å½•: /Users/username/project
  Shell: /bin/zsh
  å»ºè®®: å°è¯•åœ¨ç»ˆç«¯ä¸­ç›´æ¥è¿è¡Œä¸Šè¿°å‘½ä»¤ä»¥è·å–æ›´å¤šä¿¡æ¯
```

ä»è¿™ä¸ªè¾“å‡ºå¯ä»¥çœ‹å‡ºï¼š

- åˆ†æ”¯åˆ›å»ºæˆåŠŸ
- æ¨é€å¤±è´¥æ˜¯å› ä¸ºç½‘ç»œé—®é¢˜ï¼ˆæ— æ³•è§£æ github.comï¼‰

### åœºæ™¯ 3ï¼šStash åˆ›å»ºå¤±è´¥

```bash
$ gw s --debug

ğŸ› Debug æ¨¡å¼å·²å¯ç”¨

æ²¡æœ‰ stash è®°å½•
âœ” æ£€æµ‹åˆ°æœªæäº¤çš„å˜æ›´ï¼Œæ˜¯å¦åˆ›å»º stash? æ˜¯
âœ” Stash æ¶ˆæ¯ (å¯é€‰): ä¸´æ—¶ä¿å­˜ï¼šä¿®å¤bug

[DEBUG] æ‰§è¡Œå‘½ä»¤: git stash push -m "ä¸´æ—¶ä¿å­˜ï¼šä¿®å¤bug"
[DEBUG] é€€å‡ºç : 0
[DEBUG] æ ‡å‡†è¾“å‡º:
Saved working directory and index state On master: ä¸´æ—¶ä¿å­˜ï¼šä¿®å¤bug

âœ” Stash åˆ›å»ºæˆåŠŸ
```

## å¯¹æ¯”ï¼šæ™®é€šæ¨¡å¼ vs Debug æ¨¡å¼

### æ™®é€šæ¨¡å¼

```bash
$ gw tag

âœ” é€‰æ‹© tag å‰ç¼€: v (æœ€æ–°: v1.5.2)
å½“å‰æœ€æ–° tag: v1.5.2

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âœ” é€‰æ‹©ç‰ˆæœ¬ç±»å‹: patch  â†’ v1.5.3

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âœ— tag åˆ›å»ºå¤±è´¥
  fatal: Failed to resolve 'HEAD' as a valid ref.
```

### Debug æ¨¡å¼

```bash
$ gw tag --debug

ğŸ› Debug æ¨¡å¼å·²å¯ç”¨

âœ” é€‰æ‹© tag å‰ç¼€: v (æœ€æ–°: v1.5.2)
å½“å‰æœ€æ–° tag: v1.5.2

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âœ” é€‰æ‹©ç‰ˆæœ¬ç±»å‹: patch  â†’ v1.5.3

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

[DEBUG] æ‰§è¡Œå‘½ä»¤: git tag -a "v1.5.3" -m "Release v1.5.3"
[DEBUG] é€€å‡ºç : 128
[DEBUG] é”™è¯¯è¾“å‡º:
fatal: Failed to resolve 'HEAD' as a valid ref.

âœ— tag åˆ›å»ºå¤±è´¥
  fatal: Failed to resolve 'HEAD' as a valid ref.

[DEBUG] æ•…éšœæ’æŸ¥ä¿¡æ¯:
  å‘½ä»¤: git tag -a "v1.5.3" -m "Release v1.5.3"
  å·¥ä½œç›®å½•: /Users/username/cmk-vue
  Shell: /bin/zsh
  å»ºè®®: å°è¯•åœ¨ç»ˆç«¯ä¸­ç›´æ¥è¿è¡Œä¸Šè¿°å‘½ä»¤ä»¥è·å–æ›´å¤šä¿¡æ¯
```

## å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜ 1ï¼šFailed to resolve 'HEAD'

**é”™è¯¯ä¿¡æ¯ï¼š**

```
fatal: Failed to resolve 'HEAD' as a valid ref.
```

**åŸå› ï¼š** ä»“åº“æ²¡æœ‰ä»»ä½•æäº¤

**è§£å†³æ–¹æ³•ï¼š**

```bash
git add .
git commit -m "Initial commit"
gw tag
```

### é—®é¢˜ 2ï¼šTag already exists

**é”™è¯¯ä¿¡æ¯ï¼š**

```
fatal: tag 'v1.5.3' already exists
```

**åŸå› ï¼š** Tag å·²ç»å­˜åœ¨

**è§£å†³æ–¹æ³•ï¼š**

```bash
# åˆ é™¤æ—§ tag
git tag -d v1.5.3
git push origin --delete v1.5.3

# é‡æ–°åˆ›å»º
gw tag
```

### é—®é¢˜ 3ï¼šNetwork error

**é”™è¯¯ä¿¡æ¯ï¼š**

```
fatal: unable to access 'https://github.com/...': Could not resolve host
```

**åŸå› ï¼š** ç½‘ç»œè¿æ¥é—®é¢˜

**è§£å†³æ–¹æ³•ï¼š**

- æ£€æŸ¥ç½‘ç»œè¿æ¥
- æ£€æŸ¥ä»£ç†è®¾ç½®
- ç¨åé‡è¯•

### é—®é¢˜ 4ï¼šPermission denied

**é”™è¯¯ä¿¡æ¯ï¼š**

```
fatal: could not read Username for 'https://github.com': terminal prompts disabled
```

**åŸå› ï¼š** æ²¡æœ‰é…ç½® Git å‡­æ®

**è§£å†³æ–¹æ³•ï¼š**

```bash
# é…ç½® SSH
ssh-keygen -t ed25519 -C "your_email@example.com"
# æ·»åŠ  SSH key åˆ° GitHub

# æˆ–ä½¿ç”¨ HTTPS + token
git config --global credential.helper store
```

## æäº¤ Bug æŠ¥å‘Š

å¦‚æœä½ é‡åˆ°é—®é¢˜éœ€è¦æäº¤ bug æŠ¥å‘Šï¼Œè¯·ï¼š

1. **ä½¿ç”¨ debug æ¨¡å¼é‡ç°é—®é¢˜**

   ```bash
   gw <command> --debug > debug.log 2>&1
   ```

2. **åŒ…å«ä»¥ä¸‹ä¿¡æ¯**
   - å®Œæ•´çš„ debug è¾“å‡º
   - æ“ä½œç³»ç»Ÿå’Œ Shell ç‰ˆæœ¬
   - Git ç‰ˆæœ¬ï¼š`git --version`
   - gw ç‰ˆæœ¬ï¼š`gw --version`
   - ä»“åº“çŠ¶æ€ï¼š`git status`

3. **æäº¤åˆ° GitHub Issues**
   - é™„ä¸Š `debug.log` æ–‡ä»¶
   - æè¿°æœŸæœ›çš„è¡Œä¸º
   - æè¿°å®é™…çš„è¡Œä¸º

## æ€§èƒ½å½±å“

Debug æ¨¡å¼ä¼šï¼š

- âœ… æ•è·é¢å¤–çš„è¾“å‡ºä¿¡æ¯
- âœ… æ˜¾ç¤ºæ›´å¤šæ—¥å¿—
- âš ï¸ è½»å¾®å¢åŠ æ‰§è¡Œæ—¶é—´ï¼ˆé€šå¸¸ < 100msï¼‰
- âœ… ä¸å½±å“å‘½ä»¤çš„å®é™…åŠŸèƒ½

å»ºè®®ï¼š

- æ—¥å¸¸ä½¿ç”¨ï¼šä¸å¯ç”¨ debug æ¨¡å¼
- é‡åˆ°é—®é¢˜ï¼šå¯ç”¨ debug æ¨¡å¼æ’æŸ¥
- æäº¤ bugï¼šå¿…é¡»æä¾› debug è¾“å‡º

## ç›¸å…³å‘½ä»¤

```bash
# æŸ¥çœ‹ç‰ˆæœ¬
gw --version
gw -v

# æŸ¥çœ‹å¸®åŠ©
gw --help
gw -h

# å¯ç”¨ debug
gw <command> --debug
gw <command> -d

# ç»„åˆä½¿ç”¨ï¼ˆä¸æ”¯æŒï¼‰
# âŒ gw --version --debug  # ä¸ä¼šæ˜¾ç¤º debug ä¿¡æ¯
# âœ… gw tag --debug        # æ­£ç¡®ç”¨æ³•
```

## å®ç°ç»†èŠ‚

Debug æ¨¡å¼é€šè¿‡ä»¥ä¸‹æ–¹å¼å®ç°ï¼š

1. **å…¨å±€æ ‡å¿—**ï¼šåœ¨ä¸»å…¥å£è®¾ç½®å…¨å±€ `DEBUG_MODE` æ ‡å¿—
2. **å‘½ä»¤æ‹¦æˆª**ï¼šåœ¨ `execAsync` ä¸­æ£€æŸ¥ debug æ¨¡å¼
3. **è¾“å‡ºæ•è·**ï¼šæ•è· stdout å’Œ stderr
4. **æ ¼å¼åŒ–è¾“å‡º**ï¼šä½¿ç”¨é¢œè‰²å’Œå‰ç¼€æ ‡è¯† debug ä¿¡æ¯

ç›¸å…³æ–‡ä»¶ï¼š

- `src/index.ts` - è§£æ `--debug` å‚æ•°
- `src/utils.ts` - å®ç° debug è¾“å‡ºé€»è¾‘
